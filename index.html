<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Crypto Trader</title>
    <link rel="stylesheet" href="css/styles.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-database-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
</head>
<body>
    <div class="phone-frame">
        <!-- Auth Screen -->
        <div id="authScreen" class="auth-screen" style="display: none;">
            <!-- Auth content loaded by auth.js -->
        </div>

        <!-- Game Screen -->
        <div id="gameScreen">
        <!-- User Info -->
        <div class="header">
            <span>User: <strong id="username">Player</strong></span>
            <div style="display: flex; gap: 8px;">
                <button class="reset-btn" id="resetBtn">RESET</button>
                <button class="logout-btn" id="logoutBtn" onclick="window.handleLogout()">LOGOUT</button>
            </div>
        </div>

        <!-- Portfolio Overview -->
        <div class="info-grid">
            <div class="info-box">
                <div class="info-label">CASH</div>
                <div class="info-value">
                    $<span id="cash">10000</span>
                </div>
            </div>
            <div class="info-box">
                <div class="info-label">NET WORTH</div>
                <div class="info-value">
                    $<span id="networth-detail">10000</span>
                </div>
            </div>
        </div>

        <!-- Portfolio Toggle Button -->
        <div style="display: flex; gap: 10px; margin: 15px 0;">
            <button class="view-toggle-btn" id="portfolioToggleBtn" style="flex: 1;">
                PORTFOLIO
            </button>
            <button class="view-toggle-btn" id="blackjackToggleBtn" style="flex: 1;">
                BLACKJACK
            </button>
            <button class="view-toggle-btn" id="leaderboardToggleBtn" style="flex: 1;">
                LEADERBOARD
            </button>
            <button class="view-toggle-btn" id="chatToggleBtn" style="flex: 1;">
                CHAT
            </button>
        </div>

        <!-- Market View -->
        <div id="marketView" class="view-panel active">
            <!-- Coin Selector -->
            <div class="section">
                <div class="section-header-with-button">
                    <button class="section-header-btn" id="coinSelectorToggle">SELECT COIN ▼</button>
                    <button class="create-coin-btn" id="createCoinBtn">+ CREATE COIN</button>
                </div>
                <div class="coin-selector" id="coinSelector">
                    <!-- Coins will be populated by JS -->
                </div>
                <div class="coin-selector-expanded" id="coinSelectorExpanded" style="display: none;">
                    <!-- Expanded coin list will be populated by JS -->
                </div>
            </div>

        <!-- Current Coin Info -->
        <div class="info-grid">
            <div class="info-box">
                <div class="info-label">HOLDING</div>
                <div class="info-value">
                    <span id="holding">0.00000000</span>
                    <span class="currency" id="coin-symbol">BTC</span>
                </div>
            </div>
            <div class="info-box">
                <div class="info-label">PRICE</div>
                <div class="info-value">
                    $<span id="price">0.00</span>
                    <span class="price-change up" id="priceChange">+0.0%</span>
                </div>
            </div>
        </div>

        <!-- Chart -->
        <div class="section">
            <div class="section-header">Price History</div>
            <div class="chart-container">
                <div class="chart-controls">
                    <div class="time-buttons">
                        <button class="time-btn" data-timeframe="1h">1h</button>
                        <button class="time-btn active" data-timeframe="24h">24h</button>
                        <button class="time-btn" data-timeframe="7d">7d</button>
                    </div>
                </div>
                <canvas id="priceChart"></canvas>
            </div>
        </div>

        <!-- Trading Section -->
        <div class="section">
            <div class="trade-section">
                <div class="trade-header">Buy <span id="buy-coin-name">BTC</span></div>
                <div class="input-group">
                    <div class="input-wrapper">
                        <input type="number" id="buyAmount" placeholder="$ Amount" step="0.01">
                    </div>
                    <button class="quick-btn" data-action="buy" data-fraction="0.5">1/2</button>
                    <button class="quick-btn" data-action="buy" data-fraction="1">ALL</button>
                </div>
                <div class="receive-amount">Receive: <span id="buyReceive">0</span> <span id="buy-coin-symbol">BTC</span></div>
                <button class="trade-btn" id="buyBtn">BUY</button>
            </div>

            <div class="trade-section">
                <div class="trade-header">Sell <span id="sell-coin-name">BTC</span></div>
                <div class="input-group">
                    <div class="input-wrapper">
                        <input type="number" id="sellAmount" placeholder="Crypto Amount" step="0.00000001">
                    </div>
                    <button class="quick-btn" data-action="sell" data-fraction="0.5">1/2</button>
                    <button class="quick-btn" data-action="sell" data-fraction="1">ALL</button>
                </div>
                <div class="receive-amount">Receive: $<span id="sellReceive">0.00</span></div>
                <button class="trade-btn sell" id="sellBtn">SELL</button>
            </div>
        </div>

        <!-- Tabs -->
        <div class="tabs">
            <button class="tab-btn active" data-tab="history">History</button>
        </div>

        <!-- Transaction History -->
        <div class="tab-content active" id="history-tab">
            <div class="section-header">Transaction History</div>
            <div class="transaction-list" id="transactionList">
                <div class="empty-state">No transactions yet</div>
            </div>
        </div>
        </div><!-- End Market View -->

        <!-- Portfolio View -->
        <div id="portfolioView" class="view-panel">
            <div class="section">
                <div class="section-header">Your Holdings</div>
                <div class="portfolio-list" id="portfolioList">
                    <!-- Portfolio items will be populated by JS -->
                </div>
            </div>
        </div><!-- End Portfolio View -->

        <!-- Blackjack View -->
        <div id="blackjackView" class="view-panel">
            <div class="section">
                <div class="section-header">♠️ Blackjack Table ♥️</div>
                
                <!-- Dealer's Hand -->
                <div class="blackjack-hand">
                    <div class="hand-label">Dealer: <span id="dealerTotal">0</span></div>
                    <div class="cards" id="dealerCards"></div>
                </div>

                <!-- Player's Hand -->
                <div class="blackjack-hand">
                    <div class="hand-label">You: <span id="playerTotal">0</span></div>
                    <div class="cards" id="playerCards"></div>
                </div>

                <!-- Betting Area -->
                <div class="blackjack-bet-area" id="betArea">
                    <div class="section-header">Place Your Bet</div>
                    <div style="display: flex; gap: 10px; margin: 10px 0;">
                        <input type="number" id="betAmount" class="portfolio-quick-input" placeholder="Bet amount" step="10" style="flex: 1;">
                        <button class="portfolio-quick-btn" onclick="window.quickBet(100)">$100</button>
                        <button class="portfolio-quick-btn" onclick="window.quickBet(500)">$500</button>
                        <button class="portfolio-quick-btn" onclick="window.quickBet(1000)">$1K</button>
                        <button class="portfolio-quick-btn" onclick="window.quickBetAll()">ALL</button>
                    </div>
                    <button class="trade-btn" id="dealBtn" onclick="window.startBlackjack()">DEAL</button>
                </div>

                <!-- Game Actions -->
                <div class="blackjack-actions" id="gameActions" style="display: none;">
                    <button class="trade-btn" onclick="window.blackjackHit()">HIT</button>
                    <button class="trade-btn sell" onclick="window.blackjackStand()">STAND</button>
                </div>

                <!-- Game Result -->
                <div class="blackjack-result" id="gameResult"></div>
            </div>
        </div><!-- End Blackjack View -->

        <!-- Leaderboard View -->
        <div id="leaderboardView" class="view-panel">
            <div class="section">
                <div class="section-header">Top Traders</div>
                <div class="leaderboard-list" id="leaderboardList">
                    <div class="empty-state">Loading...</div>
                </div>
            </div>
        </div><!-- End Leaderboard View -->

        <!-- Chat View -->
        <div id="chatView" class="view-panel">
            <div class="section">
                <div class="section-header">Global Chat</div>
                <div class="chat-messages" id="chatMessages">
                    <div class="empty-state">Loading messages...</div>
                </div>
                <div class="chat-input-container">
                    <input type="text" id="chatInput" class="chat-input" placeholder="Type a message..." maxlength="200">
                    <button class="trade-btn" id="chatSend">SEND</button>
                </div>
            </div>
        </div><!-- End Chat View -->

        </div><!-- End Game Screen -->
    </div><!-- End Phone Frame -->

    <!-- Username Modal -->
    <div class="modal" id="usernameModal">
        <div class="modal-content">
            <h2>Enter Username</h2>
            <input type="text" id="usernameInput" placeholder="Your username" maxlength="15">
            <button class="trade-btn" id="usernameSubmit">START TRADING</button>
        </div>
    </div>

    <!-- Create Coin Modal -->
    <div class="modal" id="createCoinModal">
        <div class="modal-content">
            <h2>Create Custom Coin</h2>
            <p class="modal-info">Cost: $1,000</p>
            <input type="text" id="coinNameInput" placeholder="Coin Name (e.g., MyCoin)" maxlength="20">
            <input type="text" id="coinSymbolInput" placeholder="Ticker Symbol (e.g., MYC)" maxlength="5">
            <div class="modal-buttons">
                <button class="trade-btn" id="createCoinSubmit">CREATE</button>
                <button class="trade-btn sell" id="createCoinCancel">CANCEL</button>
            </div>
        </div>
    </div>

    <!-- Game Over Modal -->
    <div class="modal" id="gameOverModal">
        <div class="modal-content">
            <h2 style="color: var(--text-danger);">GAME OVER</h2>
            <p style="font-size: 14px; margin: 15px 0; color: var(--text-primary);">
                You've lost everything!<br>
                Cash: $0.00 | Portfolio: $0.00
            </p>
            <button class="trade-btn" id="gameOverReset">TRY AGAIN</button>
        </div>
    </div>

    <!-- Scripts -->
    <script type="module" src="js/config.js"></script>
    <script type="module" src="js/notifications.js"></script>
    <script type="module" src="js/firebase.js"></script>
    <script type="module" src="js/market.js"></script>
    <script type="module" src="js/game.js"></script>
    <script type="module" src="js/trading.js"></script>
    <script type="module" src="js/chart.js"></script>
    <script type="module" src="js/ui.js"></script>
    <script type="module" src="js/main.js"></script>
</body>
</html>